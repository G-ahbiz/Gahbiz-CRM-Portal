<div class="form-group mb-3">
  <!-- Label -->
  <label [for]="id" class="form-label">
    {{ label }} <span [class]="asteriskColorDanger">{{ asterisk }}</span>
  </label>

  <!-- Input Container for Phone/Password variants -->
  @if (variant === 'phone' || variant === 'password') {
  <div class="position-relative">
    <!-- Phone Dropdown Button (appears before input) -->
    @if (variant === 'phone') {
    <div class="position-absolute top-50 translate-middle-y" style="left: 0.5rem; z-index: 3">
      <button
        type="button"
        class="btn btn-sm d-flex align-items-center gap-1 p-1"
        style="font-size: 0.875rem"
        (click)="toggleDropdown($event)"
        [attr.aria-expanded]="isOpen"
      >
        <span class="fi fi-{{ selectedCountry.iso2 }}"></span>
        <span>{{ selectedCountry.dialCode }}</span>
        <svg
          [class.rotate-180]="isOpen"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          style="width: 0.75rem; height: 0.75rem; transition: transform 0.2s"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M19 9l-7 7-7-7"
          />
        </svg>
      </button>

      @if (isOpen) {
      <ul
        class="dropdown-menu show position-absolute border rounded shadow-lg overflow-auto"
        style="z-index: 20; width: 12rem; left: 0; margin-top: 0.25rem; max-height: 15rem"
      >
        @for (c of countries; track c.iso2) {
        <li
          (click)="selectCountry(c); $event.stopPropagation()"
          class="dropdown-item d-flex align-items-center gap-2 cursor-pointer"
        >
          <span class="fi fi-{{ c.iso2 }}"></span>
          <span class="ms-2">{{ c.dialCode }}</span>
        </li>
        }
      </ul>
      }
    </div>
    }

    <!-- Main Input -->
    <input
      [id]="id"
      [type]="variant === 'password' ? (showPassword ? 'text' : 'password') : 'text'"
      class="form-control"
      [class.ps-5]="variant === 'phone'"
      [ngModel]="variant === 'phone' ? phoneNumber : value"
      (ngModelChange)="onInputChange($event)"
      (blur)="handleBlur()"
      [attr.placeholder]="placeholder"
      [attr.disabled]="disabled ? true : null"
      [attr.maxlength]="maxlength"
      [attr.minlength]="minlength"
      [attr.pattern]="pattern"
      [attr.aria-describedby]="errorId"
    />

    <!-- Password Toggle -->
    @if (variant === 'password') {
    <app-lock-password
      class="position-absolute top-50 translate-middle-y"
      style="right: 0.75rem"
      [(showPassword)]="showPassword"
    >
    </app-lock-password>
    }
  </div>
  } @else {
  <!-- Simple Input for other variants -->
  <input
    [id]="id"
    [type]="'text'"
    class="form-control"
    [ngModel]="value"
    (ngModelChange)="onInputChange($event)"
    (blur)="handleBlur()"
    [attr.placeholder]="placeholder"
    [attr.disabled]="disabled ? true : null"
    [attr.maxlength]="maxlength"
    [attr.minlength]="minlength"
    [attr.pattern]="pattern"
    [attr.aria-describedby]="errorId"
  />
  }

  <!-- Error Message -->
  @if (isInvalid) {
  <div [id]="errorId" class="text-danger small mt-1">
    {{ errorMessage }}
  </div>
  }
</div>
