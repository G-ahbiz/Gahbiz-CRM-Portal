<div class="container-fluid p-0 m-0">

  <div
    class="invoice-details-container p-3 d-flex flex-column justify-content-start align-items-start gap-3 overflow-x-hidden overflow-y-auto">
    <!-- Invoice Details Top -->
    <div class="invoice-details-top w-100 d-flex justify-content-start align-items-center gap-3">
      <div class="invoice-details-back-btn-container">
        <button
          class="back-btn btn btn-sm p-2 bg-white shadow border-0 d-flex justify-content-center align-items-center"
          (click)="goBack()">
          <i class="pi pi-chevron-left fs-875"></i>
        </button>
      </div>
      <h1 class="mb-0 fs-4 fw-bold">{{ 'invoices-crm.invoice-details.title' | translate }}</h1>
    </div>

    <!-- Invoice Details Content -->
    <div class="invoice-details-content w-100 d-flex flex-column justify-content-start align-items-start gap-3 mt-5">
      <!-- Invoice Details Top -->
      <div class="invoice-details-top-container d-flex justify-content-between align-items-start gap-3 w-100">
        <div class="invoice-id-container d-flex flex-column justify-content-center align-items-start gap-2">

          <!-- Invoice ID -->
          <h6 class="fs-6 fw-semibold">
            {{ 'invoices-crm.invoice-details.invoice-id' | translate }} #{{ currentInvoice?.id }}
          </h6>

          <!-- Bill Date -->
          <p class="m-0 p-0 text-muted-clr fs-875">
            {{ 'invoices-crm.invoice-details.bill-date' | translate }}
            {{ currentInvoice?.billDate | date:'EE, MMM dd,yyyy' }}
          </p>

          <!-- Due Date -->
          <p class="m-0 p-0 text-muted-clr fs-875">
            {{ 'invoices-crm.invoice-details.due-date' | translate }}
            {{ currentInvoice?.dueDate | date:'EE, MMM dd,yyyy' }}
          </p>

          <!-- statues -->
          <p
            class="m-0 p-0 text-muted-clr fs-875 {{ currentInvoice?.status === 'Paid' ? 'card-green trend-up-clr' : currentInvoice?.status === 'Partially Paid' ? 'card-yellow text-warning' : currentInvoice?.status === 'Unpaid' ? 'card-red trend-down-clr' : '' }} px-3 py-2 rounded-4 fw-medium">
            {{ currentInvoice?.status | translate }}
          </p>
        </div>
        <!-- Invoice Actions Container -->
        <div class="invoice-actions-container d-flex justify-content-center align-items-center gap-3"
          (change)="onStatusChange($event)">
          <!-- Status Select -->
          <select class="form-select" aria-label="Default select" id="statusSelect">
            <option selected disabled>{{ 'invoices-crm.invoice-details.change-status' | translate }}</option>
            <option value="Paid">{{ 'invoices-crm.invoice-details.paid' | translate }}</option>
            <option value="Partially Paid">{{ 'invoices-crm.invoice-details.partially-paid' | translate }}</option>
            <option value="Unpaid">{{ 'invoices-crm.invoice-details.unpaid' | translate }}</option>
          </select>
          <!-- Save Button -->
          <button
            class="btn btn-sm btn-primary primary-bg-clr px-3 py-2 d-flex justify-content-center align-items-center gap-2 rounded-3">
            {{ 'invoices-crm.invoice-details.save' | translate }}
          </button>
          <!-- Download Button -->
          <button
            class="btn btn-sm btn-primary primary-bg-clr px-3 py-2 d-flex justify-content-center align-items-center gap-2 rounded-3">
            <i class="pi pi-download"></i>
            {{ 'invoices-crm.invoice-details.download' | translate }}
          </button>
          <!-- Print Button -->
          <button
            class="btn btn-sm btn-primary primary-bg-clr px-3 py-2 d-flex justify-content-center align-items-center gap-2 rounded-3">
            <i class="pi pi-print"></i>
            {{ 'invoices-crm.invoice-details.print' | translate }}
          </button>
        </div>
      </div>

      <!-- Order Details Body -->
      <div class="order-details-body w-100 d-flex flex-column justify-content-start align-items-start gap-3 w-100">
        <div class="cards-container w-100">
          <!-- Cards Container Top -->
          <div class="cards-container-top d-flex flex-wrap justify-content-start align-items-start gap-3 w-100">
            <!-- Customer Card -->
            <div class="card border-0">
              <div class="card-body d-flex justify-content-start align-items-start gap-3">
                <!-- Card Icon -->
                <div class="card-icon rounded-circle p-3 d-flex justify-content-center align-items-center">
                  <img src="assets/images/orders/cutomer.svg" alt="Customer Icon" class="">
                </div>
                <!-- Card Info -->
                <div class="card-info d-flex flex-column justify-content-start align-items-start gap-3">
                  <h5 class="card-title m-0 fw-semibold">Customer</h5>
                  <p class="customer-name m-0 fw-medium fs-6">
                    <span class="text-muted-clr">Name: </span>
                    <span>{{ currentCustomer?.fullName }}</span>
                  </p>
                  <p class="customer-email m-0 fw-medium fs-6">
                    <span class="text-muted-clr">Email: </span>
                    <span>{{ currentCustomer?.email }}</span>
                  </p>
                  <p class="customer-phone m-0 fw-medium fs-6">
                    <span class="text-muted-clr">Phone: </span>
                    <span>{{ currentCustomer?.phoneNumber }}</span>
                  </p>
                </div>
              </div>
            </div>

            <!-- Amount Card -->
            <div class="card border-0">
              <div class="card-body d-flex justify-content-start align-items-start gap-3">
                <!-- Card Icon -->
                <div class="card-icon rounded-circle p-3 d-flex justify-content-center align-items-center">
                  <img src="assets/images/invoices/money.svg" alt="Money Icon" class="">
                </div>
                <!-- Card Info -->
                <div class="card-info d-flex flex-column justify-content-start align-items-start gap-3">
                  <h5 class="card-title m-0 fw-semibold">Amount</h5>
                  <p class="shipping-address m-0 fw-medium fs-6">
                    <span class="text-muted-clr">Total: </span>
                    <span class="fw-medium">$ {{ currentInvoice?.total }}</span>
                  </p>
                  <p class="customer-email m-0 fw-medium fs-6">
                    <span class="text-muted-clr">Payment Received: </span>
                    <span class="fw-medium">$ {{ currentInvoice?.paymentReceived }}</span>
                  </p>
                  <p class="customer-phone m-0 fw-medium fs-6">
                    <span class="text-muted-clr">Due: </span>
                    <span class="fw-medium">$ {{ currentInvoice?.due }}</span>
                  </p>
                </div>
              </div>
            </div>

            <!-- Delivery Card -->
            <div class="card border-0">
              <div class="card-body d-flex justify-content-start align-items-start gap-3">
                <!-- Card Icon -->
                <div class="card-icon rounded-circle p-3 d-flex justify-content-center align-items-center">
                  <img src="assets/images/invoices/delivery.svg" alt="" class="">
                </div>
                <!-- Card Info -->
                <div class="card-info d-flex flex-column justify-content-start align-items-start gap-3">
                  <h5 class="card-title m-0 fw-semibold">Delivery</h5>
                  <p class="customer-name m-0 fw-medium fs-6">
                    <span class="text-muted-clr">Address: </span>
                    <span>{{ currentCustomer?.state }}</span>
                  </p>
                  <p class="customer-email m-0 fw-medium fs-6">
                    <span class="text-muted-clr">State: </span>
                    <span>{{ currentCustomer?.state }}</span>
                  </p>
                  <p class="customer-phone m-0 fw-medium fs-6">
                    <span class="text-muted-clr">Postal Code: </span>
                    <span>{{ currentCustomer?.postalCode }}</span>
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- Order Details Bottom -->
          <div class="cards-container-bottom d-flex flex-wrap justify-content-start align-items-start gap-3 w-100 mt-4">
            <!-- Payment Info Card -->
            <div class="card border-0">
              <div class="card-body d-flex justify-content-start align-items-start gap-3">
                <!-- Card Icon -->
                <div class="card-icon rounded-circle p-3 d-flex justify-content-center align-items-center">
                  <img src="assets/images/orders/payment.svg" alt="" class="">
                </div>
                <!-- Card Info -->
                <div class="card-info d-flex flex-column justify-content-start align-items-start gap-3">
                  <h5 class="card-title m-0 fw-semibold">Payment Info</h5>
                  <p class="customer-name m-0 fw-medium fs-6">
                    <span class="text-muted-clr">Payment Method: </span>
                    <span>{{ currentInvoice?.paymentReceived }}</span>
                  </p>
                  <p class="customer-email m-0 fw-medium fs-6">
                    <span class="text-muted-clr">Business Name: </span>
                    <span>{{ currentInvoice?.customer }}</span>
                  </p>
                  <p class="customer-phone m-0 fw-medium fs-6">
                    <span class="text-muted-clr">Expiration Date: </span>
                    <span>{{ currentInvoice?.dueDate }}</span>
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="services-history-container w-100 h-100">
          <h4 class="fs-5 fw-semibold">Services</h4>

          <table class="table table-hover w-100 mt-3">
            <thead>
              <tr>
                <th>
                  <input type="checkbox" name="" id="">
                </th>
                <th>Name</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Total</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              @for (service of servicesHistory; track service.id ; let i = $index) {
              <tr>
                <td scope="col"><input type="checkbox" name="select-service" id="service-{{ service.id }}"></td>
                <td scope="col">{{ service.name }}</td>
                <td scope="col">$ {{ service.price }}</td>
                <td scope="col">{{ service.quantity }}</td>
                <td scope="col">$ {{ service.total }}</td>
                <td>
                  <button class="btn btn-sm bg-transparent border-0">
                    <i class="pi pi-ellipsis-v"></i>
                  </button>
                  <button class="btn btn-sm bg-transparent border-0">
                    <i class="pi pi-trash"></i>
                  </button>
                </td>
              </tr>
              }
              <tr class="">
                <td scope="col" colspan="3">Summury</td>
                <td scope="col">{{servicesTotalQuantity}}</td>
                <td scope="col">$ {{servicesTotalPrice}}</td>
              </tr>
            </tbody>
          </table>
        </div>

      </div>

    </div>


  </div>
